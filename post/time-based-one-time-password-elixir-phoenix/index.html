<!doctype html><html lang=en><head><title>Taking MFA to next level - A new approach!</title><meta http-equiv=content-type content="text/html" charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge,chrome=1"><meta name=viewport content="width=device-width,initial-scale=1"><link rel=stylesheet href=https://mangalakader.github.io/css/header.css><link rel=stylesheet href=https://mangalakader.github.io/css/index.css><link rel=stylesheet href=https://mangalakader.github.io/css/footer.css><link rel=stylesheet href=https://mangalakader.github.io/css/bootstrap-icons-150.css><link rel=stylesheet href=https://mangalakader.github.io/css/bootstrap-501.min.css><script src=https://mangalakader.github.io/js/jquery.min.js></script><script src=https://mangalakader.github.io/js/bootstrap-501.bundle.min.js></script><script src=https://mangalakader.github.io/js/index.js></script><link rel=apple-touch-icon sizes=180x180 href=/apple-touch-icon.png><link rel=icon type=image/png sizes=32x32 href=/favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=/favicon-16x16.png><link rel=manifest href=/site.webmanifest><script>(function(a,c,e,f,d,b){a.hj=a.hj||function(){(a.hj.q=a.hj.q||[]).push(arguments)},a._hjSettings={hjid:1579889,hjsv:6},d=c.getElementsByTagName('head')[0],b=c.createElement('script'),b.async=1,b.src=e+a._hjSettings.hjid+f+a._hjSettings.hjsv,d.appendChild(b)})(window,document,'https://static.hotjar.com/c/hotjar-','.js?sv=')</script></head><body><div class="progress-container fixed-top"><span class=progress-bar></span></div><nav class="slide-in-blurred-top navbar navbar-expand-lg navbar-light bg-transparent fixed-top"><div class="container-fluid px-0"><a class="navbar-brand logo text-focus-in ms-3 mt-3" href=/>PMK</a>
<button class="bg-warning rounded-start border-0 mt-1" type=button data-bs-toggle=offcanvas data-bs-target=#offcanvasRight aria-controls=offcanvasRight><i class="bi bi-chevron-double-left"></i></button></div><div class="offcanvas offcanvas-end bg-warning bg-warning-gradient" tabindex=-1 data-bs-scroll=true id=offcanvasRight aria-labelledby=offcanvasRightLabel><div class=offcanvas-header><h5 id=offcanvasRightLabel class=fw-bold>Menu</h5><button type=button class="btn-close text-reset" data-bs-dismiss=offcanvas aria-label=Close></button></div><div class=offcanvas-body><div class="container-fluid p-0"><ul class="list-group list-group-flush"><a href=/#home><li class="list-group-item active" aria-current=true>Home</li></a><a href=/#intro><li class=list-group-item>Introduction</li></a><a href=/#exp1><li class=list-group-item>Work Experience</li></a><a href=/#oss1><li class=list-group-item>Open Source Contributions</li></a><a href=/blog><li class=list-group-item>Blog</li></a><a href=/tags><li class=list-group-item>Tags</li></a></ul></div></div></div></nav><div id=title class="container-fluid bg-warning bg-warning-gradient p-5"><h2 class="text-dark text-center p-3 p-lg-5">Taking MFA to next level - A new approach!</h2><h5 class="text-dark text-center">Dec 12, 2019</h5></div><div id=content class="text-white container-fluid bg-dark bg-dark-gradient p-5 post-container"><h2 id=what-is-totp>What is TOTP?</h2><p>Those who have enabled multi-factor authentication (mfa) in his/her Google accounts, major vendors out there are aware of the importance of having them. For others, who are not aware of
what mfa is and how it works, please look into the following wiki link: TOTP Wiki Page</p><h3 id=traditional-approach-of-totp-apps>Traditional Approach of TOTP apps:</h3><p>Most of the Authenticator apps out there, starts providing One Time Password easily, when you:</p><ul><li>scan the QR code provided to you</li><li>Enter the secret text provided to you</li></ul><h3 id=why-this-might-not-be-the-completely-safest-approach>Why this might not be the completely safest approach?</h3><p>There is <strong>no way to tell whether the rightful owner is scanning the QR code or using the key</strong>, which makes it a bit vulnerable. I&rsquo;m not arguing about it&rsquo;s existence, but the mere fact that what if someone gets hold of my secret key and password, they can easily generate the OTPs and get access to my systems. Many, people might say that we need to start using Password Generators for this purpose, I&rsquo;m in fact, voting in favor of them. The next thing that I&rsquo;m about share might sound silly, but has worked well for many of my clients and users.</p><h3 id=a-small-step-can-improve-the-situation-a-little-bit-better>A small step can improve the situation a little bit better:</h3><ul><li>Instead of the sending the encoded secret key as QR code to email or account, just <strong>generate a custom url from the application with an expirable token of considerable time and convert that URL to QR code and share it with the users.</strong></li><li>The expirable token can be used only within the <strong>time limit</strong> and it makes the identity clear, when checked in the application side</li><li>The <strong>Authenticator app</strong> needs to have a <strong>particular user-agent or some kind of signature header to differentiate the requests from the app</strong></li><li>The above step makes sure that no other people can get access to TOTP secret key.</li><li>The Authenticator App needs to scan and hit the URL with the distinguished mark to get the TOTP secret key.</li></ul><p>The above mentioned steps are just <strong>suggestions</strong> for those who feel the necessity of implementing your own MFA solution and are in need to monitor or track the access usage safely.</p><br><div class="p-3 border-top"><i class="bi bi-tags-fill"></i>&nbsp;&nbsp;
<a href=https://mangalakader.github.io/tags/elixir/ class="tags text-decoration-none text-white">elixir
(5)</a>
,
<a href=https://mangalakader.github.io/tags/phoenix/ class="tags text-decoration-none text-white">phoenix
(1)</a>
,
<a href=https://mangalakader.github.io/tags/mfa/ class="tags text-decoration-none text-white">mfa
(1)</a>
,
<a href=https://mangalakader.github.io/tags/one-time-password/ class="tags text-decoration-none text-white">one-time-password
(1)</a>
,
<a href=https://mangalakader.github.io/tags/totp/ class="tags text-decoration-none text-white">totp
(1)</a></div></div><div class="container-fluid justify-content-evenly p-0 row g-0"><div class="next-post col-lg btn-secondary p-3 text-center"><a class="link-reverse text-decoration-none text-white" href="https://mangalakader.github.io/post/xmpp-mongooseim-ejabberd-erlang-journey-part-1/?ref=footer"><div class="d-inline-flex flex-row align-items-center"><i class="bi bi-arrow-left-circle-fill fs-2"></i><h5 class=m-0>&nbsp;&nbsp;Instant Messaging using erlang and XMPP...</h5></div></a></div><div class="previous-post col-lg btn-secondary p-3 text-center"><a class="link-reverse text-decoration-none text-white" href="https://mangalakader.github.io/post/elixir-shell-recompile-noop-issue/?ref=footer"><div class="d-inline-flex flex-row align-items-center"><h5 class=m-0>Elixir - How to solve recompile :noop...&nbsp;&nbsp;</h5><i class="bi bi-arrow-right-circle-fill fs-2"></i></div></a></div></div><footer class="bg-dark bg-dark-gradient"><div class="d-flex justify-content-center py-5 container-fluid text-white">&copy; 2021, Mangala Kader, All rights reserved.</div></footer></body></html>